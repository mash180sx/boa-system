// Generated by CoffeeScript 1.3.1
(function() {
  var BSON, conf, db, limit, no_new_rate, no_used_rate, out_collection, total_size;

  conf = require('./config');

  db = require('./lib/db');

  BSON = db.mongodb.BSONPure;

  no_used_rate = 0.8;

  no_new_rate = 10.0;

  out_collection = "temp";

  limit = 1000;

  total_size = 1000;

  db.open(conf.db, function(err, client) {
    var Temp, fields, index, options, query;
    if (err) {
      throw err;
    }
    Temp = client.collection('temp');
    query = {};
    fields = {};
    options = {
      sort: [["value.gross_profit", -1], ["value.gross_profit_ratio", 1]]
    };
    if (limit > 0) {
      options.limit = limit;
    }
    index = 0;
    return Temp.find(query, fields, options).each(function(err, doc) {
      if (err) {
        throw err;
      }
      console.log(index++, JSON.stringify(doc));
      if (doc === null) {
        client.close();
        return process.exit();
      }
    });
  });

}).call(this);
